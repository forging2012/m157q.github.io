<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  CO Ch5 - Large and Fast Exploiting Memory Hierarchy
 | Just for noting</title>

    <meta name="author" content="m157q"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="https://blog.m157q.tw/theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="https://blog.m157q.tw/theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="https://blog.m157q.tw/theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="https://blog.m157q.tw/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://blog.m157q.tw/favicon.ico" type="image/x-icon">

    <!-- Feeds -->
      <link href="https://blog.m157q.tw/feeds/all.feed.atom.xml" type="application/atom+xml" rel="alternate" title="Just for noting - All posts - Atom Feed"/>
      <link href="https://blog.m157q.tw/feeds/all.feed.rss.xml" type="application/rss+xml" rel="alternate" title="Just for noting - All posts - RSS Feed"/>
      <link href="https://blog.m157q.tw/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Just for noting - Latest posts - Atom Feed"/>
      <link href="https://blog.m157q.tw/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Just for noting - Latest posts - RSS Feed"/>
      <link href="https://blog.m157q.tw/feeds/category.course.atom.xml" type="application/atom+xml" rel="alternate" title="Just for noting - Category: Course - Atom Feed"/>
      <link href="https://blog.m157q.tw/feeds/category.course.rss.xml" type="application/rss+xml" rel="alternate" title="Just for noting - Category: Course - RSS Feed"/>

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-45367183-2', 'auto');
    ga('send', 'pageview');
    </script>



  </head>

  <body>

    <div class="container">

      <div class="page-header">
        <h1><a href="https://blog.m157q.tw">Just for noting</a> <small></small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://blog.m157q.tw" title="">Just for noting</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                <a href="/categories">Categories</a>
              </li>
<li >
                <a href="/archives">Archives</a>
              </li>
<li >
                <a href="/tags">Tags</a>
              </li>
<li >
                  <a href="https://blog.m157q.tw/pages/cv/">CV</a>
                </li>
          </ul>


            <form class="navbar-form navbar-right" role="search" action="https://blog.m157q.tw/search.html" onsubmit="return validateForm(this.elements['q'].value);">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" name="q" id="tipue_search_input" class="form-control search-query" placeholder="Search" required />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fa
                        fa-search fa-fw"></i></button>
                  </span>
                </div>
              </div>
            </form>

        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="https://blog.m157q.tw/posts/2013/11/25/co-ch5-large-and-fast-exploiting-memory-hierarchy/" rel="bookmark" title="Permalink to CO Ch5 - Large and Fast Exploiting Memory Hierarchy">CO Ch5 - Large and Fast Exploiting Memory Hierarchy</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <blockquote>
    <h1>NCTUCS 2013-Fall Computer Organizaion by ...</h1>
  </blockquote>
  <div>
    <h1>NCTUCS 2013-Fall Computer Organizaion by Professor Kai-Chiang Wu</h1>
<h1>Ch5 - Large and Fast Exploiting Memory Hierarchy</h1>
<h2>Memory Technology</h2>
<ul>
<li>SRAM  </li>
<li>DRAM  </li>
<li>Williams-Kilburn tubes: 早期的 Memory 技術  </li>
</ul>
<hr />
<h2>Memory Hierarchy Levels</h2>
<blockquote>
<p>教授：我去美國唸書的時候，教授都把 Cache Memory 直接簡寫成 $<br />
所以之後我寫 $ 也是代表 Cache Memory  </p>
</blockquote>
<ul>
<li>$ 在設計的時候通常都是跟 CPU 一起設計的，雖然他不在 CPU 裡面  </li>
<li>CPU 透過 Mother board 上的 Bus 和 $ 交流資料  </li>
<li>根據 Instruction Set 決定放在 $ 裡面的 Address 佔幾個 Word. (也就是設計 Block 的大小)  </li>
</ul>
<hr />
<h2>Cache Memory</h2>
<ul>
<li>除了 Register 以外，最接近 CPU 的 Memory  </li>
</ul>
<hr />
<h2>Direct Mapped Cache</h2>
<blockquote>
<p>因為主記憶體比 Cache 大很多，無法直接全部對應到 Cache，所以必須有特殊的對應方法。  </p>
</blockquote>
<ul>
<li>Direct mapped: only one choice  <ul>
<li>(Block address) modulo (#Blocks in cache)  <ul>
<li>Block 的位置除以 Cache 的 Block 總數後得到的餘數就是該 Block Address 要對應到的 Cache Address  </li>
<li>其實沒有真的去作除法，直接看後面 3 個 bit (除以8得到的餘數，因為這裡的 cache 有 8 個)  </li>
</ul>
</li>
</ul>
</li>
<li>N-way associative: N choices  <ul>
<li>
<h1>Blocks is a power of 2</h1>
</li>
<li>Use low-order address bits  </li>
<li>tag, index, offset(W.O., B.O.)  <ul>
<li>tag 代表了從 cache 如何找到該資料是存在哪個 block address  </li>
<li>index 代表了該 block address 存在 cache 中的位置  </li>
<li>offset 根據 block 大小不同而訂  <ul>
<li>W.O.: Word offset  </li>
<li>B.O.: Byte offset  </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<h2>Tags and Valid Bits</h2>
<ul>
<li>Tag:  <ul>
<li>從 cache 如何找到該資料是存在哪個 block address  </li>
<li>cache 也要存 tag，之後才知道要去找哪個 block  </li>
</ul>
</li>
<li>Valid Bit  <ul>
<li>該 cache 無資料 =&gt; 0  </li>
<li>該 cache 有資料 =&gt; 1  </li>
</ul>
</li>
</ul>
<hr />
<h2>Cache Example</h2>
<p>見投影片 p.10 ~ p.15  </p>
<ul>
<li>22 =&gt; 10110  <ul>
<li>tag =&gt; 10  </li>
<li>index =&gt; 110  </li>
<li>Hit/miss  <ul>
<li>要找的東西的 tag 和 index 有沒有已經存在 cache 中(tag 和 index 皆相同)  </li>
<li>沒的話就是 miss, 有的話就是 hit  </li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<h2>Address Subdivision</h2>
<p>見 p.16  </p>
<ul>
<li>byte address  </li>
<li>2^n blocks  </li>
<li>block data size 2^m words  </li>
</ul>
<p>聽不太懂  </p>
<hr />
<h2>Address Translation</h2>
<ul>
<li>Virtual Memory  </li>
</ul>
<hr />
<h2>Page Fault Penalty</h2>
<ul>
<li>Page Fault means that the data we find is not in the phyiscal address but disk storage.  </li>
<li>Virtual Memory 經過 page table 查找後，無法在 Physical Address 找到，則為 Page Fault。  </li>
<li>Page Fault 類似 cache 裡面的 miss  </li>
<li>Millions of clock cycles (比 cache 的 panelty 大)  </li>
</ul>
<hr />
<h2>Page Tables</h2>
<p>p.51  </p>
<ul>
<li>Virtual Address (VA) -&gt; Page Table (PT) -&gt; Physical Address (PA)  </li>
<li>page table entries (PTEs)  </li>
<li><strong>page table register</strong> in CPU points to page table in physical memory  </li>
<li>status bits  <ul>
<li>referenced  </li>
<li>dirty - 先標記起來，之後讀寫  </li>
<li>valid - 是不是真的有資料  <ul>
<li>If valid bit is zero, the page fault occurs and the data is not in the physical address but disk storage.  </li>
</ul>
</li>
</ul>
</li>
<li>Every Page Table entry is 4 bytes.  </li>
</ul>
<hr />
<h2>Translation Using a Page Table</h2>
<p>p.52  </p>
<ul>
<li>We can know the amount of page offset by knowing 4 bytes per page table entry.  </li>
<li>Virtual address(32 bits) = Virtual page number(32-x bits) + Page Offset(x bits)  <ul>
<li>x depends on the size of the page.  </li>
<li>x is usually 12bits. (4KB per page)  </li>
</ul>
</li>
</ul>
<hr />
<h2>Replacement and Writes</h2>
<ul>
<li>use least-recently used (LRU) to reduce page fault rate.  </li>
<li>use dirty bit in PTE set when page is written to reduce the access to main memory.  </li>
</ul>
<hr />
<h2>Page Table Problems</h2>
<ul>
<li>page table is <strong>too big</strong>  </li>
<li>Access to page table is <strong>too slow</strong>  </li>
</ul>
<hr />
<h2>Fast Translation Using a TLB</h2>
<ul>
<li>VA -&gt; PT (in main memory) / TLB (in CPU for usually used) -&gt; PA  </li>
<li>Translation Look-aside Buffer (TLB)  <ul>
<li>use a fast cache of PTEs within the CPU  </li>
<li>access to page tables has good <strong>time locality</strong>  </li>
<li>Extra misses occured when query in TLB failed. (queried data is in PT)  </li>
<li>Those Misses could be handled by hardware or software  </li>
</ul>
</li>
</ul>
  </div>

    <hr>
    <section>
        <p id="post-share-links">
            <h3>Share</h3>
            <a href="https://twitter.com/intent/tweet?text=CO%20Ch5%20-%20Large%20and%20Fast%20Exploiting%20Memory%20Hierarchy%0Ahttps%3A//blog.m157q.tw/posts/2013/11/25/co-ch5-large-and-fast-exploiting-memory-hierarchy/%0Avia%20%40M157q%0A" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square fa-3x"></i></a>
            <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A//blog.m157q.tw/posts/2013/11/25/co-ch5-large-and-fast-exploiting-memory-hierarchy/" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square fa-3x"></i></a>
            <a href="https://plus.google.com/share?url=https%3A//blog.m157q.tw/posts/2013/11/25/co-ch5-large-and-fast-exploiting-memory-hierarchy/" target="_blank" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-3x"></i></a>
            <a href="mailto:?subject=CO%20Ch5%20-%20Large%20and%20Fast%20Exploiting%20Memory%20Hierarchy&amp;body=https%3A//blog.m157q.tw/posts/2013/11/25/co-ch5-large-and-fast-exploiting-memory-hierarchy/" target="_blank" title="Share via Email"><i class="fa fa-envelope-o fa-3x"></i></a>
        </p>
    </section>

<hr>
<section id="donation">
    <h3>Donation</h3>
    <p id="donation-chinese">
      如果覺得這篇文章對你有幫助，
      除了留言讓我知道外，
      或許也可以考慮請我喝杯咖啡，
      不論金額多寡我都會非常感激且能鼓勵我繼續寫出對你有幫助的文章。
    </p>
    <p id="donation-english">
      If this blog post happens to be helpful to you, besides of leaving a reply, you may consider buy me a cup of coffee to support me. It would help me write more articles helpful to you in the future and I would really appreciate it.
    </p>
    <ul id="donation-address">
			<li><a href="https://payment.opay.tw/Broadcaster/Donate/4E163AAE10E448A30DB244CF85527271">歐付寶</a></li>

			<li><a href="https://www.paypal.me/m157q">PayPal</a></li>

			<li>BTC: <a href="https://blockchain.info/address/1HWMzBGTQ8VUJGXgvSDzAFacfeY2sLiZda">1HWMzBGTQ8VUJGXgvSDzAFacfeY2sLiZda</a></li>

			<li>ETH: <a href="https://etherscan.io/address/0x0380433c5cdda13c8cd6cff5ddbcc1d7701bcb83">0x0380433c5cdda13c8cd6cff5ddbcc1d7701bcb83</a></li>

			<li>LTC: <a href="https://chainz.cryptoid.info/ltc/address.dws?LUFkjq32kEAiYqnMG25isqGNdgkehj9rJT.htm">LUFkjq32kEAiYqnMG25isqGNdgkehj9rJT</a></li>
    </ul>
</section>

    <hr>
    <h3>Related Posts</h3>
    <!-- TODO: Use fancier related layout, as in http://kevin.deldycke.com/2012/04/beautify-contextual-related-posts-wordpress-plugin/ -->
    <ul>
        <li><a href="https://blog.m157q.tw/posts/2013/11/25/co-ch4-the-processor/">CO Ch4 - The Processor</a></li>
      </ul>

    <div class="comments">
      <div id="disqus_thread"></div>
	  <script type="text/javascript">
        var disqus_shortname = 'm157q-logdown';
        var disqus_identifier = "posts/2013/11/25/co-ch5-large-and-fast-exploiting-memory-hierarchy/";
        var disqus_title = "CO Ch5 - Large and Fast Exploiting Memory Hierarchy";
        var disqus_url = "https://blog.m157q.tw/posts/2013/11/25/co-ch5-large-and-fast-exploiting-memory-hierarchy/";

        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
        };
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.</noscript>
    </div>

        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2013-11-25T07:53:00+08:00"><i class="fa fa-calendar"></i> Mon 25 November 2013</abbr></p>


      <p><address>
        <i class="fa fa-user"></i> By
          <a href="https://blog.m157q.tw/author/m157q.html" rel="author">m157q</a>
      </address></p>

    <hr/>

      <p>
              <p>
              <a href="https://blog.m157q.tw/category/course/" rel="tag"
                  data-toggle="tooltip"
                  class="label label-info"
                  title="37 articles in this category">Course</a>
              </p>
            <a href="/tag/computer-organization/" data-toggle="tooltip"
      class="label label-default"
      title="2 articles with this tag">Computer Organization</a>
  <br>
      </p>
      <hr/>


      <nav>
        <ul class="pager">
          <li class="previous ">
            <a  href="https://blog.m157q.tw/posts/2013/11/25/itse-ch11-review-techniques/" title="ITSE Ch11 - Review Techniques"  rel="prev">
              <span aria-hidden="true">←</span> Older
            </a>
          </li>
          <li class="next ">
            <a  href="https://blog.m157q.tw/posts/2013/11/25/co-ch4-the-processor/" title="CO Ch4 - The Processor"  rel="next">
              Newer <span aria-hidden="true">→</span>
            </a>
          </li>
        </ul>
      </nav>

  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
                <h5>Social</h5>
                <ul class="list-unstyled">
                  <li>  <a href="https://github.com/M157q">
      <i class="fa fa-github"></i>
    GitHub
  </a></li>
                  <li>  <a href="https://www.twitter.com/M157q">
      <img src="https://icons.better-idea.org/icon?url=www.twitter.com&size=16" width="16" height="16" class="icon" alt="www.twitter.com icon"/>
    Twitter
  </a></li>
                </ul>
            </div>
            <div class="col-md-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://getpelican.com/">
      <img src="https://icons.better-idea.org/icon?url=getpelican.com&size=16" width="16" height="16" class="icon" alt="getpelican.com icon"/>
    Pelican
  </a></li>
                  <li>  <a href="http://python.org/">
      <img src="https://icons.better-idea.org/icon?url=python.org&size=16" width="16" height="16" class="icon" alt="python.org icon"/>
    Python.org
  </a></li>
                  <li>  <a href="http://jinja.pocoo.org/">
      <img src="https://icons.better-idea.org/icon?url=jinja.pocoo.org&size=16" width="16" height="16" class="icon" alt="jinja.pocoo.org icon"/>
    Jinja2
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>Browse content by</h5>
            <ul class="list-unstyled">
                <li><a href="https://blog.m157q.tw/categories/index.html"><i class="fa fa-tags"></i> Categories</a></li>
                <li><a href="https://blog.m157q.tw/archives/index.html"><i class="fa fa-calendar"></i> Dates</a></li>
                <li><a href="https://blog.m157q.tw/tags/index.html"><i class="fa fa-tag"></i> Tags</a></li>
            </ul>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Copyright notice</h5>
            <p>© Copyright 2013-2018 m157q.</p>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Disclaimer</h5>
              <p>All opinions expressed in this site are my own personal opinions and are not endorsed by, nor do they represent the opinions of my previous, current and future employers or any of its affiliates, partners or customers.</p>
          </div>

          <div class="col-md-2">
              <h5>Feeds</h5>
              <ul class="list-unstyled">
                  <li><small><a href="https://blog.m157q.tw/feeds/all.feed.atom.xml"><i class="fa fa-rss"></i> All posts (Atom)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/all.feed.rss.xml"><i class="fa fa-rss"></i> All posts (RSS)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/atom.xml"><i class="fa fa-rss"></i> Latest posts (Atom)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/rss.xml"><i class="fa fa-rss"></i> Latest posts (RSS)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/category.course.atom.xml"><i class="fa fa-rss"></i> Category: Course (Atom)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/category.course.rss.xml"><i class="fa fa-rss"></i> Category: Course (RSS)</a></small></li>
              </ul>
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="https://blog.m157q.tw/theme/js/jquery.mglass.js"></script>
    <script src="https://blog.m157q.tw/theme/js/application.js"></script>

  </body>
</html>