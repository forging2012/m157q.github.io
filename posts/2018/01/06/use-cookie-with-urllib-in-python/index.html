<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>  Python ä¸­è®“ urllib ä½¿ç”¨ cookie çš„æ–¹æ³•
 | Just for noting</title>

    <meta name="author" content="m157q"/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css"/>
    <link rel="stylesheet" href="https://blog.m157q.tw/theme/css/jquery.mglass.css"/>
    <link rel="stylesheet" href="https://blog.m157q.tw/theme/css/pygment-solarized-dark.css"/>
    <link rel="stylesheet" href="https://blog.m157q.tw/theme/css/style.css"/>

    <!-- Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Droid+Sans+Mono' rel='stylesheet' type='text/css'/>


    <link rel="icon" href="https://blog.m157q.tw/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://blog.m157q.tw/favicon.ico" type="image/x-icon">

    <!-- Feeds -->
      <link href="https://blog.m157q.tw/feeds/all.feed.atom.xml" type="application/atom+xml" rel="alternate" title="Just for noting - All posts - Atom Feed"/>
      <link href="https://blog.m157q.tw/feeds/all.feed.rss.xml" type="application/rss+xml" rel="alternate" title="Just for noting - All posts - RSS Feed"/>
      <link href="https://blog.m157q.tw/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Just for noting - Latest posts - Atom Feed"/>
      <link href="https://blog.m157q.tw/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Just for noting - Latest posts - RSS Feed"/>
      <link href="https://blog.m157q.tw/feeds/category.note.atom.xml" type="application/atom+xml" rel="alternate" title="Just for noting - Category: Note - Atom Feed"/>
      <link href="https://blog.m157q.tw/feeds/category.note.rss.xml" type="application/rss+xml" rel="alternate" title="Just for noting - Category: Note - RSS Feed"/>

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-45367183-2', 'auto');
    ga('send', 'pageview');
    </script>



  </head>

  <body>

    <div class="container">

      <div class="page-header">
        <h1><a href="https://blog.m157q.tw">Just for noting</a> <small></small></h1>
      </div>

      <nav class="navbar navbar-default">

        <!-- Hamburger menu for mobile -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#plumage-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://blog.m157q.tw" title="">Just for noting</a>
        </div>

        <!-- Menus and search forms -->
        <div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">

          <ul class="nav navbar-nav">
<li >
                <a href="/categories">Categories</a>
              </li>
<li >
                <a href="/archives">Archives</a>
              </li>
<li >
                <a href="/tags">Tags</a>
              </li>
<li >
                  <a href="https://blog.m157q.tw/pages/cv/">CV</a>
                </li>
          </ul>


            <form class="navbar-form navbar-right" role="search" action="https://blog.m157q.tw/search.html" onsubmit="return validateForm(this.elements['q'].value);">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" name="q" id="tipue_search_input" class="form-control search-query" placeholder="Search" required />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fa
                        fa-search fa-fw"></i></button>
                  </span>
                </div>
              </div>
            </form>

        </div>

      </nav>

    </div>


    <div class="container main">


      <div class="row">
        <div class=" col-md-9  ">
  <h1>
    <a href="https://blog.m157q.tw/posts/2018/01/06/use-cookie-with-urllib-in-python/" rel="bookmark" title="Permalink to Python ä¸­è®“ urllib ä½¿ç”¨ cookie çš„æ–¹æ³•">Python ä¸­è®“ urllib ä½¿ç”¨ cookie çš„æ–¹æ³•</a>
  </h1>
        </div>
      </div>

      <div class="row">


        <div class=" col-md-9 " id="content" role="main">
  

  <blockquote>
    <p>ç´€éŒ„ä¸€ä¸‹åœ¨ urllib ä½¿ç”¨ cookie çš„æ–¹æ³•ã€‚</p>
  </blockquote>
  <div>
    <h2>å‰è¨€</h2>
<p>å…¶å¯¦ä¸€èˆ¬ä¾†èªªåªè¦ç”¨ <a href="https://github.com/requests/requests"><code>requests</code></a> é€™å€‹è¶…å¼·çš„ third-party library å°±å¯ä»¥è§£äº†ï¼Œ<code>requests</code> å·²ç¶“æŠŠ Cookie çš„éƒ¨ä»½è™•ç†å¥½äº†ï¼Œé‚£ç‚ºä»€éº¼è¦ç´€éŒ„é€™ç¯‡ï¼Ÿå…¶å¯¦é€™å•é¡Œä¹Ÿæ˜¯ç´„è«ä¸€å¹´å‰åœ¨å‰å…¬å¸å·¥ä½œæ™‚é‡åˆ°çš„å•é¡Œï¼Œä»¥ä¸‹èªªæ˜ä¸€ä¸‹ï¼š  </p>
<p>Google App Engine Standard Environment é™¤äº†é è¨­ä½¿ç”¨ Python 2 ä»¥å¤–ï¼ŒåŠ ä¸Šå› ç‚ºæ˜¯ PaaS çš„é—œä¿‚ï¼Œåšäº†ä¸å°‘é™åˆ¶ï¼Œç›´æ¥æ‹¿ <code>requests</code> ä¾†ç”¨çš„è©±æœƒç„¡æ³•ä½¿ç”¨ï¼Œå¿…é ˆå†æ­é… <a href="https://github.com/requests/toolbelt"><code>requests-toolbelt</code></a> é€™å€‹å·¥å…·ï¼Œè®“ <code>requests</code> åœ¨ GAE Standard ä¸Šä½¿ç”¨çš„æ™‚å€™ï¼Œåº•å±¤æœƒæŠ½æ›æˆ GAE æä¾›çš„ <code>urlfetch</code>ï¼Œé€™æ¨£æ‰èƒ½ä½¿ç”¨ï¼Œè€Œåœ¨ GAE Standard ä¸Šé è¨­å¯ä»¥ä½¿ç”¨ <code>urlfetch</code> å’Œ <code>urllib2</code>ã€‚  </p>
<p>é‚£ç‚ºä»€éº¼ä¸ç”¨ <code>requests</code> å°±å¥½äº†ï¼Ÿå› ç‚º Legacy code çš„ç·£æ•…ï¼Œç„¡æ³•å¾ˆè¼•æ˜“ä½¿ç”¨ <code>requests</code>ï¼Œæ‰€ä»¥æ¡ç”¨ <code>urllib2</code>ï¼Œä½†åˆé‡åˆ°æœ‰éœ€è¦ä½¿ç”¨ Cookie çš„éœ€æ±‚ï¼Œè€Œ <code>urllib2</code> æ˜¯æ²’æœ‰æ”¯æ´ Cookie çš„ï¼Œæ‰€ä»¥å°±å¿…é ˆå†æ­é… <code>cookielib</code> ä¾†ä½¿ç”¨ã€‚  </p>
<p>å°±ç”¨é€™ç¯‡æ–‡ç« ç´€éŒ„ä¸€ä¸‹ä½œæ³•ï¼Œé †ä¾¿é€£ Python 3 çš„å¯«æ³•ä¹Ÿé †ä¾¿ç´€éŒ„ä¸€ä¸‹ï¼Œå› ç‚º Python 2 è£¡çš„ <code>urllib2</code> å’Œ <code>cookielib</code> åœ¨ Python 3 è£¡é ­éƒ½æœ‰åšæ›´å‹•ã€‚é †ä¾¿ä¹ŸæŠŠæœ€ç°¡å–®çš„ <code>requests</code> çš„å¯«æ³•ä¹Ÿä¸€ä½µé™„ä¸Šã€‚  </p>
<hr />
<h2>Python 2: <code>urllib2</code> + <code>cookielib</code></h2>
<p><strong>Python 2 ä¸­çš„ <code>urllib2</code> æ˜¯ <code>urllib</code> çš„åŠ å¼·ç‰ˆï¼Œåœ¨å¯¦éš›ä½¿ç”¨ä¸Šæ¯”è¼ƒå¸¸ä½¿ç”¨ <code>urllib2</code>ï¼Œæ‰€ä»¥é€™è£¡ç›´æ¥è¬› <code>urllib2</code> çš„å¯«æ³•ã€‚</strong>  </p>
<h3>åŸºæœ¬ä½¿ç”¨</h3>
<p>ç¯„ä¾‹å…¶å¯¦åœ¨å®˜æ–¹ç¶²ç«™çš„èªªæ˜æ–‡ä»¶æœ€åº•ä¸‹çš„ç¯„ä¾‹å°±æœ‰äº†ï¼š<a href="https://docs.python.org/2/library/cookielib.html#examples">20.21. cookielib â€” Cookie handling for HTTP clients â€” Python 2.7.14 documentation</a>ï¼Œå…¶å¯¦ä¹Ÿä¸æœƒå¾ˆè¤‡é›œã€‚  </p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cookielib</span><span class="o">,</span> <span class="nn">urllib2</span>  
<span class="n">cj</span> <span class="o">=</span> <span class="n">cookielib</span><span class="o">.</span><span class="n">CookieJar</span><span class="p">()</span>  
<span class="n">opener</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">HTTPCookieProcessor</span><span class="p">(</span><span class="n">cj</span><span class="p">))</span>  
<span class="n">r</span> <span class="o">=</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;http://example.com/&quot;</span><span class="p">)</span>  
</pre></div>


<h3>ä¸å¾æª”æ¡ˆåŒ¯å…¥ï¼Œç›´æ¥è¨­å®š Cookie</h3>
<p>ä½†å¦‚æœä»Šå¤©æˆ‘å€‘æ²’æœ‰ä¸€ä»½å…ˆå­˜å¥½çš„ Cookie è¨­å®šæª”ï¼Œå»åˆæƒ³åœ¨ç™¼é€ request å‰é å…ˆè¨­å®šä¸€äº› Cookie çš„ value æ€éº¼è¾¦ï¼Ÿå…ˆè¬›çµè«–ï¼šã€Œæœ‰è¾¦æ³•åšåˆ°ï¼Œä½†ä¸æ¨è–¦ä½¿ç”¨ã€‚ã€ï¼ˆå¦‚æœæ˜¯è¦æ”¹ "User-Agent" çš„è©±ï¼Œé€™å€‹æ˜¯ request headerï¼Œè€Œä¸æ˜¯ cookieï¼Œæ‰€ä»¥æ˜¯ <code>urllib</code> è¦è™•ç†ï¼Œè€Œä¸æ˜¯ <code>cookielib</code> è™•ç†ï¼Œè«‹å‹¿ææ··ã€‚ï¼‰  </p>
<p><code>cookielib.CookieJar</code> æœ‰å€‹ <code>set_cookie()</code> çš„å‡½å¼ï¼Œå…¶é è¨­æ¥æ”¶çš„åƒæ•¸æ˜¯ <code>cookielib.Cookie</code>ï¼Œä½† <code>cookielib.Cookie</code> çš„æ–‡ä»¶ä¸­å»æœ‰è‘—ä»¥ä¸‹é€™æ®µèªªæ˜ï¼š  </p>
<blockquote>
<p>This class represents Netscape, RFC 2109 and RFC 2965 cookies. It is not expected that users of <code>cookielib</code> construct their own <code>Cookie</code> instances. Instead, if necessary, call <code>make_cookies()</code> on a <code>CookieJar</code> instance.  </p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯èªªï¼Œé è¨­å…¶å¯¦æ˜¯ä¸æœŸæœ›ä½¿ç”¨è€…è‡ªå·±è¨­å®š Cookie çš„ï¼Œä½†ä¸¦ä¸æ˜¯ä¸èƒ½åšåˆ°ï¼Œé€™å€‹åœ¨ StackOverflow ä¸Šçš„å›ç­”æœ‰çµ¦å‡ºç¯„ä¾‹ï¼š<a href="https://stackoverflow.com/questions/4685337/python-add-cookie-to-cookiejar#12682437">python - add cookie to cookiejar - Stack Overflow</a>ï¼Œä½†æˆ‘è‡ªå·±æ˜¯è¦ºå¾—éå¸¸çš„ä¸ç›´è§€ï¼Œç”¨é€™ç¨®é–‹ç™¼æ–¹å¼æ‡‰è©²å¾ˆé›£ç¶­è­·ï¼Œé™¤éåˆå§‹åŒ– <code>cookielib.Cookie</code> çš„æ™‚å€™æŠŠåƒæ•¸çš„ key éƒ½åŠ ä¸Šå»ã€‚é †å¾…ä¸€æï¼Œé€™ç¯‡æ–‡ç« çš„æå•è€…èª¤æŠŠ <code>Cookie.SimpleCooke</code> ä¸Ÿçµ¦ <code>cookielib.CookieJar.set_cookie()</code> ç•¶åƒæ•¸é¤µå…¥ï¼Œä½†é€™å€‹å‡½å¼å¯ä»¥æ¥å—çš„åƒæ•¸å¿…é ˆæ˜¯ <code>cookielib.Cookie</code>ï¼Œè€Œä¸æ˜¯ <code>Cookie.SimpleCookie</code>ï¼Œæ‰€ä»¥å‡ºäº†éŒ¯ï¼Œè€Œä¸”é€™å…©è€…ä¸¦æ²’æœ‰ä»»ä½•é—œä¿‚ï¼Œå®Œå…¨æ˜¯ç¹¼æ‰¿è‡ªä¸åŒçš„ classã€‚  </p>
<h3>å¾æª”æ¡ˆåŒ¯å…¥/åŒ¯å‡ºåˆ°æª”æ¡ˆ</h3>
<ul>
<li><a href="https://docs.python.org/2/library/cookielib.html#cookielib.FileCookieJar.save"><code>cookielib.FileCookieJar.save</code></a>  <ul>
<li>å°‡ç¾æœ‰çš„ Cookie export åˆ°æª”æ¡ˆä¸­ã€‚  </li>
</ul>
</li>
<li><a href="https://docs.python.org/2/library/cookielib.html#cookielib.FileCookieJar.load"><code>cookielib.FileCookieJar.load</code></a>  <ul>
<li>å¾æª”æ¡ˆä¸­ import Cookie çš„è¨­å®šé€²ä¾†ã€‚  </li>
</ul>
</li>
</ul>
<p>é€™æ¨£ä¸€ä¾†åœ¨å¯¦ä½œçˆ¬èŸ²æ™‚ï¼Œé‡åˆ°æœƒåˆ©ç”¨ Cookie ä¾†åˆ¤æ–·ä½¿ç”¨è€…æ˜¯å¦ç™»å…¥çš„ç¶²ç«™æ™‚å°±å¾ˆæ–¹ä¾¿ã€‚  </p>
<hr />
<h2>Python 3: <code>urllib.request</code> + <code>http.cookiejar</code></h2>
<h3>åŸºæœ¬ä½¿ç”¨</h3>
<p>ä¸€æ¨£åœ¨ Python å®˜æ–¹çš„èªªæ˜æ–‡ä»¶åº•ä¸‹å°±æœ‰ç¯„ä¾‹å¯ä»¥åƒè€ƒäº†ï¼š<a href="https://docs.python.org/3/library/http.cookiejar.html?highlight=cookiejar#examples">21.24. http.cookiejar â€” Cookie handling for HTTP clients â€” Python 3.6.4 documentation</a>  </p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">http.cookiejar</span><span class="o">,</span> <span class="nn">urllib.request</span>  
<span class="n">cj</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">cookiejar</span><span class="o">.</span><span class="n">CookieJar</span><span class="p">()</span>  
<span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">HTTPCookieProcessor</span><span class="p">(</span><span class="n">cj</span><span class="p">))</span>  
<span class="n">r</span> <span class="o">=</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;http://example.com/&quot;</span><span class="p">)</span>  
</pre></div>


<p>å…¶å¯¦å¯ä»¥çœ‹åˆ°è·Ÿ Python 2 çš„å¯«æ³•ä¸€æ¨¡ä¸€æ¨£ï¼Œåªæ˜¯æŠŠ <code>cookielib</code> æ›æˆ <code>http.cookiejar</code>ï¼Œ<code>urllib2</code> æ›æˆ <code>urllib.request</code> è€Œå·²ã€‚  </p>
<h3>ä¸å¾æª”æ¡ˆåŒ¯å…¥ï¼Œç›´æ¥è¨­å®š Cookieã€‚</h3>
<p>é€™éƒ¨ä»½è·Ÿ Python 2 ä¸€æ¨£ï¼Œå¯ä»¥åšåˆ°ï¼Œä½†ä¸æ¨è–¦ï¼Œå°±ä¸è´…è¿°ã€‚  </p>
<h3>å¾æª”æ¡ˆåŒ¯å…¥/åŒ¯å‡ºåˆ°æª”æ¡ˆ</h3>
<ul>
<li><a href="https://docs.python.org/3/library/http.cookiejar.html?highlight=cookiejar#http.cookiejar.FileCookieJar.save"><code>http.cookiejar.FileCookieJar.save</code></a>  <ul>
<li>å°‡ç›®å‰çš„ Cookie åŒ¯å‡ºåˆ°æª”æ¡ˆã€‚  </li>
</ul>
</li>
<li><a href="https://docs.python.org/3/library/http.cookiejar.html?highlight=cookiejar#http.cookiejar.FileCookieJar.load"><code>http.cookiejar.FileCookieJar.load</code></a>  <ul>
<li>å¾ç¾æœ‰çš„æª”æ¡ˆä¸­åŒ¯å…¥ Cookieã€‚  </li>
</ul>
</li>
</ul>
<hr />
<h2>requests</h2>
<p>å®˜æ–¹æ–‡ä»¶çš„ Quickstart å°±æœ‰ä¸€å€‹é—œæ–¼ Cookies çš„éƒ¨ä»½ï¼š<a href="http://docs.python-requests.org/en/master/user/quickstart/#cookies">Quickstart â€” Requests 2.18.4 documentation</a>  </p>
<p><code>requests</code> æœ¬èº«å°±è‡ªå¸¶ Cookie çš„è™•ç†äº†ï¼Œç”¨æ³•ç°¡å–®äº†è¨±å¤šï¼š  </p>
<h3>åŸºæœ¬ä½¿ç”¨</h3>
<blockquote>
<p>If a response contains some Cookies, you can quickly access them:  </p>
</blockquote>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://example.com/some/cookie/setting/url&#39;</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>  

<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">cookies</span><span class="p">[</span><span class="s1">&#39;example_cookie_name&#39;</span><span class="p">]</span>  
<span class="s1">&#39;example_cookie_value&#39;</span>  
</pre></div>


<blockquote>
<p>To send your own cookies to the server, you can use the cookies parameter:  </p>
</blockquote>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://httpbin.org/cookies&#39;</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">cookies</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cookies_are</span><span class="o">=</span><span class="s1">&#39;working&#39;</span><span class="p">)</span>  

<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>  
<span class="s1">&#39;{&quot;cookies&quot;: {&quot;cookies_are&quot;: &quot;working&quot;}}&#39;</span>  
</pre></div>


<h3>ä¸å¾æª”æ¡ˆåŒ¯å…¥ï¼Œç›´æ¥è¨­å®š Cookieã€‚</h3>
<p>åŸºæœ¬ä¸Šé€™é‚Šçš„ä½œæ³•å°±æ˜¯ä¸Šé¢ Python 2 é‚£é‚Šæåˆ°çš„ä½œæ³•ï¼Œä¸é <code>requests</code> æŠŠå‰›å‰›èªªçš„åŠ ä¸Šåƒæ•¸ key  é€™ä»¶äº‹æƒ…ç¨å¾®è™•ç†äº†ä¸€ä¸‹ã€‚  </p>
<blockquote>
<p>Cookies are returned in a <code>RequestsCookieJar</code>, which acts like a <code>dict</code> but also offers a more complete interface, suitable for use over multiple domains or paths. Cookie jars can also be passed in to requests:  </p>
</blockquote>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">jar</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">RequestsCookieJar</span><span class="p">()</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">jar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;tasty_cookie&#39;</span><span class="p">,</span> <span class="s1">&#39;yum&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;httpbin.org&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/cookies&#39;</span><span class="p">)</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">jar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;gross_cookie&#39;</span><span class="p">,</span> <span class="s1">&#39;blech&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;httpbin.org&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/elsewhere&#39;</span><span class="p">)</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://httpbin.org/cookies&#39;</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">jar</span><span class="p">)</span>  
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>  
<span class="s1">&#39;{&quot;cookies&quot;: {&quot;tasty_cookie&quot;: &quot;yum&quot;}}&#39;</span>  
</pre></div>


<h3>å¾æª”æ¡ˆåŒ¯å…¥/åŒ¯å‡ºåˆ°æª”æ¡ˆ</h3>
<p>é€™éƒ¨ä»½åœ¨ <code>requests</code> å°±æ¯”è¼ƒéº»ç…©ä¸€é»ï¼Œä½†ä¹Ÿä¸é›£ï¼Œéœ€è¦é¡å¤–ç”¨åˆ° <code>requests.utils.dict_from_cookiejar()</code>ï¼Œè©³ç´°å¯ä»¥åƒè€ƒé€™ç¯‡ StackOverflow çš„è§£ç­”ï¼š<a href="https://stackoverflow.com/questions/13030095/how-to-save-requests-python-cookies-to-a-file/13031628#13031628">How to save requests (python) cookies to a file? - Stack Overflow</a>ï¼Œå®ƒé‚„æœ‰ç”¨åˆ° <code>pickle</code> é€™å€‹å‡½å¼åº«ã€‚  </p>
<ul>
<li>ç„¡è«–æ˜¯ <code>requests.Response.cookies</code> æˆ– <code>requests.Sessions.Session.cookies</code> éƒ½æ˜¯ <code>requests.cookies.cookiejar_from_dict()</code> çš„è¼¸å‡ºçµæœã€‚  </li>
<li>å¯ä»¥ç”¨ <code>requests.utils.dict_from_cookiejar()</code> é€™å€‹å‡½å¼ï¼Œå°‡ <code>response.cookies</code> æˆ–æ˜¯ <code>session.cookies</code> ç•¶ä½œè¼¸å…¥ï¼Œå°±å¯ä»¥å¾—åˆ°è©² Cookie ä»¥ <code>dict</code> æ–¹å¼å‘ˆç¾çµæœï¼Œç•¶ç„¶ä¹Ÿå°±å¯ä»¥åŒ¯å‡ºåˆ°æª”æ¡ˆã€‚  </li>
<li>è¦åŒ¯å…¥çš„è©±ï¼Œå¯ä»¥ä½¿ç”¨ <code>requests.utils.cookiejar_from_dict()</code> é€™å€‹åƒæ•¸ä¾†æŠŠ <code>dict</code> è½‰æˆ <code>RequestsCookieJar</code>ã€‚  <ul>
<li><code>requests.utils.cookiejar_from_dict()</code> æ˜¯å¾ <code>requests.cookies</code> import ä¾†çš„ã€‚  </li>
</ul>
</li>
<li>ä½¿ç”¨åˆ° <code>pickle</code> åªæ˜¯æ–¹ä¾¿ä»¥ <code>pickle</code> çš„å½¢å¼å„²å­˜è€Œå·²ã€‚  </li>
</ul>
<hr />
<h2>çµè«–</h2>
<p>èƒ½ç”¨ <code>requests</code> çš„è©±ç•¶ç„¶å°±ç›´æ¥ç”¨å§ï¼Œå¦‚æœé‡åˆ°æˆ‘æåˆ°çš„é€™ç¨®ç‹€æ³æ‰æœƒéœ€è¦ç‰¹æ®Šçš„è§£æ³•ã€‚  </p>
<hr />
<h2>åƒè€ƒä¾†æº</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/2018026/what-are-the-differences-between-the-urllib-urllib2-and-requests-module">python - What are the differences between the urllib, urllib2, and requests module? - Stack Overflow</a>  </li>
<li><a href="https://github.com/requests/requests">GitHub - requests/requests: Python HTTP Requests for Humansâ„¢ âœ¨ğŸ°âœ¨</a>  </li>
<li><a href="https://github.com/requests/toolbelt">GitHub - requests/toolbelt: A toolbelt of useful classes and functions to be used with python-requests</a>  </li>
<li><a href="https://docs.python.org/2.7/library/urllib.html?highlight=urllib">20.5. urllib â€” Open arbitrary resources by URL â€” Python 2.7.14 documentation</a>  </li>
<li><a href="https://docs.python.org/2.7/library/urllib2.html">20.6. urllib2 â€” extensible library for opening URLs â€” Python 2.7.14 documentation</a>  </li>
<li><a href="https://docs.python.org/2/library/cookielib.html">20.21. cookielib â€” Cookie handling for HTTP clients â€” Python 2.7.14 documentation</a>  </li>
<li><a href="https://docs.python.org/3/library/urllib.html?highlight=urllib">21.5. urllib â€” URL handling modules â€” Python 3.6.4 documentation</a>  </li>
<li><a href="https://docs.python.org/3/library/http.cookiejar.html?highlight=cookiejar#module-http.cookiejar">21.24. http.cookiejar â€” Cookie handling for HTTP clients â€” Python 3.6.4 documentation</a>  </li>
<li><a href="http://docs.python-requests.org/en/master/user/quickstart/#cookies">Quickstart â€” Requests 2.18.4 documentation</a>  </li>
</ul>
  </div>

    <hr>
    <section>
        <p id="post-share-links">
            <h3>Share</h3>
            <a href="https://twitter.com/intent/tweet?text=Python%20%E4%B8%AD%E8%AE%93%20urllib%20%E4%BD%BF%E7%94%A8%20cookie%20%E7%9A%84%E6%96%B9%E6%B3%95%0Ahttps%3A//blog.m157q.tw/posts/2018/01/06/use-cookie-with-urllib-in-python/%0Avia%20%40M157q%0A" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square fa-3x"></i></a>
            <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A//blog.m157q.tw/posts/2018/01/06/use-cookie-with-urllib-in-python/" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square fa-3x"></i></a>
            <a href="https://plus.google.com/share?url=https%3A//blog.m157q.tw/posts/2018/01/06/use-cookie-with-urllib-in-python/" target="_blank" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-3x"></i></a>
            <a href="mailto:?subject=Python%20%E4%B8%AD%E8%AE%93%20urllib%20%E4%BD%BF%E7%94%A8%20cookie%20%E7%9A%84%E6%96%B9%E6%B3%95&amp;body=https%3A//blog.m157q.tw/posts/2018/01/06/use-cookie-with-urllib-in-python/" target="_blank" title="Share via Email"><i class="fa fa-envelope-o fa-3x"></i></a>
        </p>
    </section>

<hr>
<section id="donation">
    <h3>Donation</h3>
    <p id="donation-chinese">
      å¦‚æœè¦ºå¾—é€™ç¯‡æ–‡ç« å°ä½ æœ‰å¹«åŠ©ï¼Œ
      é™¤äº†ç•™è¨€è®“æˆ‘çŸ¥é“å¤–ï¼Œ
      æˆ–è¨±ä¹Ÿå¯ä»¥è€ƒæ…®è«‹æˆ‘å–æ¯å’–å•¡ï¼Œ
      ä¸è«–é‡‘é¡å¤šå¯¡æˆ‘éƒ½æœƒéå¸¸æ„Ÿæ¿€ä¸”èƒ½é¼“å‹µæˆ‘ç¹¼çºŒå¯«å‡ºå°ä½ æœ‰å¹«åŠ©çš„æ–‡ç« ã€‚
    </p>
    <p id="donation-english">
      If this blog post happens to be helpful to you, besides of leaving a reply, you may consider buy me a cup of coffee to support me. It would help me write more articles helpful to you in the future and I would really appreciate it.
    </p>
    <ul id="donation-address">
			<li><a href="https://payment.opay.tw/Broadcaster/Donate/4E163AAE10E448A30DB244CF85527271">æ­ä»˜å¯¶</a></li>

			<li><a href="https://www.paypal.me/m157q">PayPal</a></li>

			<li>BTC: <a href="https://blockchain.info/address/1HWMzBGTQ8VUJGXgvSDzAFacfeY2sLiZda">1HWMzBGTQ8VUJGXgvSDzAFacfeY2sLiZda</a></li>

			<li>ETH: <a href="https://etherscan.io/address/0x0380433c5cdda13c8cd6cff5ddbcc1d7701bcb83">0x0380433c5cdda13c8cd6cff5ddbcc1d7701bcb83</a></li>

			<li>LTC: <a href="https://chainz.cryptoid.info/ltc/address.dws?LUFkjq32kEAiYqnMG25isqGNdgkehj9rJT.htm">LUFkjq32kEAiYqnMG25isqGNdgkehj9rJT</a></li>
    </ul>
</section>

    <hr>
    <h3>Related Posts</h3>
    <!-- TODO: Use fancier related layout, as in http://kevin.deldycke.com/2012/04/beautify-contextual-related-posts-wordpress-plugin/ -->
    <ul>
        <li><a href="https://blog.m157q.tw/posts/2017/12/27/fetch-my-github-commits-in-one-organization-with-python-script/">ç”¨ Python æŠ“å‡ºæˆ‘åœ¨å‰å…¬å¸è²¢ç»äº†å¤šå°‘ GitHub commits</a></li>
        <li><a href="https://blog.m157q.tw/posts/2016/08/28/convert-html-string-to-xml-string-with-python/">Convert HTML string to XML string with Python</a></li>
        <li><a href="https://blog.m157q.tw/posts/2018/01/03/try-to-do-gofmt-in-python/">å˜—è©¦åœ¨ Python ä¸­åšåˆ° Golang fmt çš„æ•ˆæœ</a></li>
        <li><a href="https://blog.m157q.tw/posts/2017/12/22/write-a-python-script-to-retrieve-twitter-direct-messsages/">ç”¨ Python å¯«å€‹ç¨‹å¼æŠ“å‡ºæˆ‘åœ¨ Twitter ä¸Šå­˜äº†å“ªäº› tweet</a></li>
        <li><a href="https://blog.m157q.tw/posts/2018/01/07/django-rest-framework-note/">é—œæ–¼ Django REST framework çš„ä¸€äº›ç­†è¨˜</a></li>
      </ul>

    <div class="comments">
      <div id="disqus_thread"></div>
	  <script type="text/javascript">
        var disqus_shortname = 'm157q-logdown';
        var disqus_identifier = "posts/2018/01/06/use-cookie-with-urllib-in-python/";
        var disqus_title = "Python ä¸­è®“ urllib ä½¿ç”¨ cookie çš„æ–¹æ³•";
        var disqus_url = "https://blog.m157q.tw/posts/2018/01/06/use-cookie-with-urllib-in-python/";

        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
        };
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.</noscript>
    </div>

        </div>

          <div class="col-md-3">
  <div class="well">

    <p><abbr title="2018-01-06T23:57:00+08:00"><i class="fa fa-calendar"></i> Sat 06 January 2018</abbr></p>

      <p><abbr title="2018-01-07T01:42:00+08:00"><i class="fa fa-pencil"></i>Sun 07 January 2018</abbr></p>

      <p><address>
        <i class="fa fa-user"></i> By
          <a href="https://blog.m157q.tw/author/m157q.html" rel="author">m157q</a>
      </address></p>

    <hr/>

      <p>
              <p>
              <a href="https://blog.m157q.tw/category/note/" rel="tag"
                  data-toggle="tooltip"
                  class="label label-info"
                  title="119 articles in this category">Note</a>
              </p>
            <a href="/tag/python/" data-toggle="tooltip"
      class="label label-default"
      title="72 articles with this tag">Python</a>
  <br>
            <a href="/tag/2018-it-bang-bang-mang-tie-ren-sai/" data-toggle="tooltip"
      class="label label-default"
      title="31 articles with this tag">2018 iT é‚¦å¹«å¿™éµäººè³½</a>
  <br>
            <a href="/tag/python-3/" data-toggle="tooltip"
      class="label label-default"
      title="3 articles with this tag">Python 3</a>
  <br>
            <a href="/tag/python-2/" data-toggle="tooltip"
      class="label label-default"
      title="2 articles with this tag">Python 2</a>
  <br>
            <a href="/tag/cookie/" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">cookie</a>
  <br>
            <a href="/tag/urllib/" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">urllib</a>
  <br>
            <a href="/tag/requests/" data-toggle="tooltip"
      class="label label-default"
      title="1 article with this tag">requests</a>
  <br>
      </p>
      <hr/>


      <nav>
        <ul class="pager">
          <li class="previous ">
            <a  href="https://blog.m157q.tw/posts/2018/01/05/set-default-application-in-desktop-environment-on-linux/" title="Linux è¨­å®šæ¡Œé¢ç’°å¢ƒé è¨­é–‹å•Ÿç¨‹å¼"  rel="prev">
              <span aria-hidden="true">â†</span> Older
            </a>
          </li>
          <li class="next ">
            <a  href="https://blog.m157q.tw/posts/2018/01/07/django-rest-framework-note/" title="é—œæ–¼ Django REST framework çš„ä¸€äº›ç­†è¨˜"  rel="next">
              Newer <span aria-hidden="true">â†’</span>
            </a>
          </li>
        </ul>
      </nav>

  </div>
            
          </div>

      </div>

    </div>

    <!-- TODO: make footer sticky -->
    <footer class="container-fluid">
      <div class="container">
        <div class="row">

            <div class="col-md-2">
                <h5>Social</h5>
                <ul class="list-unstyled">
                  <li>  <a href="https://github.com/M157q">
      <i class="fa fa-github"></i>
    GitHub
  </a></li>
                  <li>  <a href="https://www.twitter.com/M157q">
      <img src="https://icons.better-idea.org/icon?url=www.twitter.com&size=16" width="16" height="16" class="icon" alt="www.twitter.com icon"/>
    Twitter
  </a></li>
                </ul>
            </div>
            <div class="col-md-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                  <li>  <a href="http://getpelican.com/">
      <img src="https://icons.better-idea.org/icon?url=getpelican.com&size=16" width="16" height="16" class="icon" alt="getpelican.com icon"/>
    Pelican
  </a></li>
                  <li>  <a href="http://python.org/">
      <img src="https://icons.better-idea.org/icon?url=python.org&size=16" width="16" height="16" class="icon" alt="python.org icon"/>
    Python.org
  </a></li>
                  <li>  <a href="http://jinja.pocoo.org/">
      <img src="https://icons.better-idea.org/icon?url=jinja.pocoo.org&size=16" width="16" height="16" class="icon" alt="jinja.pocoo.org icon"/>
    Jinja2
  </a></li>
                </ul>
            </div>

          <div class="col-md-2">
            <h5>Browse content by</h5>
            <ul class="list-unstyled">
                <li><a href="https://blog.m157q.tw/categories/index.html"><i class="fa fa-tags"></i> Categories</a></li>
                <li><a href="https://blog.m157q.tw/archives/index.html"><i class="fa fa-calendar"></i> Dates</a></li>
                <li><a href="https://blog.m157q.tw/tags/index.html"><i class="fa fa-tag"></i> Tags</a></li>
            </ul>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Copyright notice</h5>
            <p>Â© Copyright 2013-2018 m157q.</p>
          </div>

          <div class="col-md-2 text-muted">
            <h5>Disclaimer</h5>
              <p>All opinions expressed in this site are my own personal opinions and are not endorsed by, nor do they represent the opinions of my previous, current and future employers or any of its affiliates, partners or customers.</p>
          </div>

          <div class="col-md-2">
              <h5>Feeds</h5>
              <ul class="list-unstyled">
                  <li><small><a href="https://blog.m157q.tw/feeds/all.feed.atom.xml"><i class="fa fa-rss"></i> All posts (Atom)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/all.feed.rss.xml"><i class="fa fa-rss"></i> All posts (RSS)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/atom.xml"><i class="fa fa-rss"></i> Latest posts (Atom)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/rss.xml"><i class="fa fa-rss"></i> Latest posts (RSS)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/category.note.atom.xml"><i class="fa fa-rss"></i> Category: Note (Atom)</a></small></li>
                  <li><small><a href="https://blog.m157q.tw/feeds/category.note.rss.xml"><i class="fa fa-rss"></i> Category: Note (RSS)</a></small></li>
              </ul>
          </div>

        </div>
      </div>

      <h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>

      <div class="container">
        <div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
          <a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
      </div>

    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
    <script src="https://blog.m157q.tw/theme/js/jquery.mglass.js"></script>
    <script src="https://blog.m157q.tw/theme/js/application.js"></script>

  </body>
</html>